<!DOCTYPE html>
<html>

<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
<meta charset="utf-8" />
<meta http-equiv='X-UA-Compatible' content='IE=edge'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>
<title>Khoa học dữ liệu</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<!-- Style for main home page -->
<link rel="stylesheet" href="/assets/css/styles.css">
<link rel="stylesheet" href="/assets/css/styles_toc.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script data-ad-client="ca-pub-4263248182804679" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script> 
<link href="https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300" rel="stylesheet">
<!-- <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> -->
<link href="https://fonts.googleapis.com/css?family=Roboto|Source+Sans+Pro" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Ubuntu" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Fira+Sans" rel="stylesheet">
<link rel="icon" type="image/jpg" href="assets/images/logo.jpg" sizes="32x32">
<link rel="canonical" href="https://phamdinhkhanh.github.io"/>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="author" content="Phạm Đình Khánh" />
<meta property="og:title" content="" />
<meta property="og:site_name" content="Khanh's blog" />
<meta property="og:url" content="https://phamdinhkhanh.github.io" />
<meta property="og:description" content="" />

<meta property="og:type" content="article" />
<meta property="article:published_time" content="" />


<meta property="article:author" content="Khanh" />
<meta property="article:section" content="" />

<link rel="alternate" type="application/atom+xml" title="Khanh's blog - Atom feed" href="/feed.xml" />
<style>
	
</style>
<!-- -- Import latext  -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
	skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
	inlineMath: [['$','$']]
  }
});
</script>

<!-- Google Analytics -->

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-89509207-1', 'auto');
// ga('send', 'pageview');
ga('send', 'pageview', {
'page': '/',
'title': ''
});
</script>


<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KTCD8BX');</script>
<!-- End Google Tag Manager -->
</head>
<style>
body {
  padding: 0 7.5%;
}
</style>

<body>
	<div id="fb-root"></div>
	<!-- <script>(function(d, s, id) { -->
	  <!-- var js, fjs = d.getElementsByTagName(s)[0]; -->
	  <!-- if (d.getElementById(id)) return; -->
	  <!-- js = d.createElement(s); js.id = id; -->
	  <!-- js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.9"; -->
	  <!-- fjs.parentNode.insertBefore(js, fjs); -->
	<!-- }(document, 'script', 'facebook-jssdk'));</script> -->
	<br>
	<div content = "container">
		<div class="row">
			<div class="col-md-2 hidden-xs hidden-sm">
				<a  href="/">
					<img width="100%" style="padding-bottom: 3mm;" src="/assets/images/img.jpg" /> </a>
				<br>
				<nav>
					<div class="header">Latest</div>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/09/19/MobileNet.html">Bài 48 - Mobilenet model</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/08/23/FocalLoss.html">Bài 47 - Focal Loss trong RetinaNet</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/08/13/ModelMetric.html">Bài 46 - Đánh giá mô hình phân loại trong ML</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/08/09/ConditionalGAN.html">Bài 45 - Conditional GAN (CGAN)</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/07/25/GAN_Wasserstein.html">Bài 44 - Model Wasserstein GAN (WGAN)</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/07/13/GAN.html">Bài 43 - Model GAN</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/06/20/Unet.html">Bài 42 - Thực hành Unet</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/06/18/DeepLab.html">Bài 41 - DeepLab Sentiment Segmentation</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/06/10/ImageSegmention.html">Bài 40 - Image Segmentation</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/06/04/PhoBERT_Fairseq.html">Bài 39 - Thực hành ứng dụng BERT</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/05/31/CNNHistory.html">Bài 38 - Các kiến trúc CNN hiện đại</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/05/28/TransformerThemDauTV.html">Bài 37 - Transformer thêm dấu Tiếng Việt</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/05/23/BERTModel.html">Bài 36 - BERT model</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/05/05/MultitaskLearning_MultiBranch.html">Bài 35 - Multitask Learning - Multi Branch</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/04/22/MultitaskLearning.html">Bài 34 - Multitask Learning</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/04/15/TransferLearning.html">Bài 33 - Phương pháp Transfer Learning</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/04/09/TensorflowDataset.html">Bài 32 - Kĩ thuật tensorflow Dataset</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/04/03/AWS.html">Bài 31 - Amazon Virtual Machine Deep Learning</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/03/28/deployTensorflowJS.html">Bài 30 - Xây dựng Web AI trên tensorflow js</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/03/23/FlaskRestAPI.html">Bài 29 - Xây dựng Flask API cho mô hình deep learning</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/03/21/faceNet.html">Bài 28 - Thực hành training Facenet</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/03/12/faceNetAlgorithm.html">Bài 27 - Mô hình Facenet trong face recognition</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/03/10/DarknetGoogleColab.html">Bài 26 - Huấn luyện YOLO darknet trên google colab</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/03/09/DarknetAlgorithm.html">Bài 25 - YOLO You Only Look Once</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/02/17/ImbalancedData.html">Bài 24 - Mất cân bằng dữ liệu (imbalanced dataset)</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/02/11/NARSyscom2015.html">Bài 23 - Neural Attentive Session-Based Recommendation</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/01/17/ScoreCard.html">Bài 22 - Scorecard model</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2020/01/06/ImagePreprocessing.html">Bài 21 - Tiền xử lý ảnh OpenCV</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2019/12/26/Sorfmax_Recommendation_Neural_Network.html">Bài 20 - Recommendation Neural Network</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2019/12/12/ARIMAmodel.html">Bài 19 - Mô hình ARIMA trong time series</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2019/12/02/DeepLearningLayer.html">Bài 18 - Các layers quan trọng trong deep learning</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2019/11/22/HOG.html">Bài 17 - Thuật toán HOG (Histrogram of oriented gradient)</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2019/11/08/RFMModel.html">Bài 16 - Model RFM phân khúc khách hàng</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2019/11/04/Recommendation_Compound_Part1.html">Bài 15 - collaborative và content-based filtering</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2019/10/22/googleHeatmap.html">Bài 14 - Biểu đồ trên Google Map</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2019/10/05/SSDModelObjectDetection.html">Bài 13 - Model SSD trong Object Detection</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2019/09/29/OverviewObjectDetection.html">Bài 12 - Các thuật toán Object Detection</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2019/09/16/VisualizationPython.html">Bài 11 - Visualization trong python</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2019/09/08/LDATopicModel.html">Bài 10 - Thuật toán LDA - Xác định Topic</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2019/08/25/PyTorch_Torchtext_Tutorial.html">Bài 9 - Pytorch - Buổi 3 - torchtext module NLP</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2019/08/22/convolutional-neural-network.html">Bài 8 - Convolutional Neural Network</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2019/08/19/CorrectSpellingVietnamseTonePrediction.html">Bài 7 - Pytorch - Buổi 2 - Seq2seq model correct spelling</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2019/08/10/PytorchTurtorial1.html">Bài 6 - Pytorch - Buổi 1 - Làm quen với pytorch</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2019/07/15/PySparkSQL.html">Bài 5 - Model Pipeline - SparkSQL</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2019/06/18/AttentionLayer.html">Bài 4 -  Attention is all you need</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2019/05/10/Hypothesis_Statistic.html">Apenddix 1 - Lý thuyết phân phối và kiểm định thống kê</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2019/04/29/ModelWord2Vec.html">Bài 3 - Mô hình Word2Vec</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2019/04/22/Ly_thuyet_ve_mang_LSTM.html">Bài 2 - Lý thuyết về mạng LSTM part 2</a></li>
					
					<li><a style="text-align: left; color: #074B80"  href="/2019/01/07/Ky_thuat_feature_engineering.html">Bài 1 - Kĩ thuật feature engineering</a></li>
					
				</nav>
			</div>
			<div class="col-md-8 col-xs-12" style="z-index:1">
				<nav class="navbar navbar-inverse" style="background-color: #046897">
					<div class = "container-fluid">
						<div class = "navbar-header>
							<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
								<span class="icon-bar"></span>
								<span class="icon-bar"></span>
								<span class="icon-bar"></span>
							</button>
							<a class="navbar-brand" href="/">
								<span style="color:#FFF">Khoa học dữ liệu - Khanh's blog</span>
							</a>
						</div>
						<br>
						<br>
						<div class="collapse navbar-collapse navbar-right" id="myNavbar">
							<ul class="nav navbar-nav">
								<li><a href="/home"><span style="color: #fff"> Home</span></a></li>
								<li><a href="/about"><span style="color: #fff"> About</span></a></li>
								<!-- <li><a href="/da"><span style="color: #fff">Data Analytics</span></a></li> -->
								<!-- <li><a href="/cv"><span style="color: #fff">Computer Vision</span></a></li> -->
								<!-- <li><a href="/nlp"><span style="color: #fff">NLP</span></a></li> -->
								<!-- <li><a href="/code"><span style="color: #fff">Code</span></a></li> -->
								<li><a href="/book"><span style="color: #fff">Book</span></a></li>
							</ul>
						</div>
					</div>
				</nav>
				<div class="PageNavigation">
				</div>
				<h1 itemprop="name" class="post-title"></h1>
				<div id="bootstrap-overrides">
					<div>
<h2><p class="post-link" style="text-align: left; color: #204081; font-weight: bold">Bài 26 - Huấn luyện YOLO darknet trên google colab</p></h2> 
<strong>10 Mar 2020 - phamdinhkhanh</strong>
</div>
<br/>
<div id="toc"></div>
<h1 id="1-giới-thiệu-chung">1. Giới thiệu chung</h1>

<p>Ở bài này tôi sẽ hướng dẫn các bạn huấn luyện model YOLO trên google colab qua các khâu:</p>

<ul>
  <li>Cấu hình cài đặt GPU.</li>
  <li>Chuẩn bị dữ liệu.</li>
  <li>Cấu hình mô hình.</li>
  <li>Huấn luyện và dự báo.</li>
</ul>

<p>Qúa trình huấn luyện YOLO sẽ rất dễ xảy ra lỗi nếu chưa có kinh nghiệm. Chính vì thế tôi sẽ tổng kết các lưu ý quan trọng về lỗi khi huấn luyện mô hình trên darknet ở cuối bài. Đồng thời tôi cũng đưa ra một vài tip giúp theo dõi quá trình huấn luyện và tăng tốc độ huấn luyện.</p>

<p>Trước khi đọc bài hướng dẫn mang tính chất thực hành này, tôi khuyến nghị các bạn hãy đọc hiểu lý thuyết mô hình đã được trình bày ở <a href="https://phamdinhkhanh.github.io/2020/03/09/DarknetAlgorithm.html">Bài 25 - YOLO You Only Look Once</a>. Điều này sẽ giúp các trả lời được các câu hỏi <strong>tại sao</strong> về các lỗi huấn luyện. Sau khi đã đọc và nắm vững kiến thức ở bài 25, chỉ cần làm theo tuần tự các bước bên dưới là bạn sẽ thu được thành quả.</p>

<h1 id="2-cài-đặt-cấu-hình-cudnn">2. Cài đặt cấu hình cuDNN</h1>

<p>CUDA Deep Neural Network library (cuDNN) là một thư viện giúp tăng tốc GPU khi huấn luyện các model deep learning. Thư viện này cung cấp quá trình tối ưu huấn luyện feed forward và backpropagation trên các layers: convolution, pooling, normalization, activation. Đây là một thư viện rất mạnh và được hỗ trợ trên đa dạng các deep learning frameworks như:  Caffe,Caffe2, Chainer, Keras,MATLAB, MxNet, TensorFlow, và PyTorch.</p>

<p>Chúng ta nên sử dụng các thư viện cuDNN mới nhất vì theo như khuyến cáo của NVIDIA, nó có thể tăng tốc nhiều lần so với version cũ.</p>

<p><img src="https://developer.nvidia.com/sites/default/files/rnn-image_0.png" class="normalpic" /></p>

<p>Đối với các bạn sử dụng máy tính cá nhân đã có GPU, để sử dụng được GPU thì chúng ta phải cài đặt cuDNN. Bạn xem thêm <a href="https://developer.nvidia.com/cudnn">hướng dẫn cài đặt cuDNN - NDIVIA</a>.</p>

<p>Các bạn thực hành trên google colab có thể bỏ qua phần này vì google colab đã sẵn có cuDNN.</p>

<h1 id="3-khởi-tạo-google-colab">3. Khởi tạo google colab</h1>

<h2 id="31-google-colab">3.1. Google colab</h2>

<p><strong>Tại sao lại là google colab?</strong></p>

<ul>
  <li>
    <p>Huấn luyện model deep learning cần tài nguyên khá lớn. Đối với một quốc gia nghèo như Việt Nam thì tôi không cho rằng việc một sinh viên bỏ ra vài nghìn $ mua GPU để lắp vào Laptop là hợp lý. Trái lại, rất lãng phí và không hiệu quả.</p>
  </li>
  <li>
    <p>Google colab là một virtual cloud machine được google cung cấp miễn phí cho các nhà nghiên cứu. Đây là môi trường lý tưởng để phát triển các mô hình vừa và nhỏ. Điểm tuyệt vời ở google colab đó là môi trường của nó đã cài sẵn các packages machine learning và frame works deep learning thông dụng nhất.</p>
  </li>
  <li>
    <p>Việc cài các frame work deep learning trên máy cá nhân đôi khi khá tốn thời gian vì các lỗi xung đột package, xung đột hệ điều hành. Các bạn có thể mất vài ngày để sửa các lỗi cấu hình trên máy. Trong khi sử dụng google colab là dùng được ngay.</p>
  </li>
  <li>
    <p>Cấu hình RAM và GPU của các bạn chưa chắc đã tốt như google. Theo ước tính của tôi, bạn cần 100 triệu để xây một cấu hình máy tương đương với google colab.</p>
  </li>
  <li>
    <p>Việc sử dụng GPU trên cấu hình RAM, chip yếu có thể khiến laptop của bạn nhanh bị hỏng.</p>
  </li>
  <li>
    <p>Với google colab, bạn có thể dễ dàng làm việc với data được chia sẻ trên google drive từ người khác.</p>
  </li>
</ul>

<p>Bên cạnh sử dụng google colab thì bạn có thể sử dụng một số virtual cloud mà tôi nghĩ cũng rất hay đó là:</p>

<ul>
  <li>
    <p><a href="https://www.kaggle.com/getting-started/78482">kaggle kernel</a>. Kaggle kernel có một kho tài nguyên vô hạn về dữ liệu và jupyter notebook practice từ các data scientist master. Đồng thời kaggle kernel hỗ trợ cả ngôn ngữ R rất phù hợp với người làm tài chính, thống kê.</p>
  </li>
  <li>
    <p><a href="https://notebooks.azure.com/help/jupyter-notebooks">jupyter notebook- azure</a>. Tôi chỉ nghe qua, cũng chưa sử dụng.</p>
  </li>
</ul>

<p>Quay trở lại thực hành, tại bước này cần tạo một google colab. Các bạn vào google drive, sau đó click vào <code class="highlighter-rouge">New &gt; More &gt; Google colab</code>.</p>

<p><img src="https://imgur.com/Xl4qJ0X.png" class="normalpic" /></p>

<p>Một màn hình google colab hiện ra, có chức năng gần giống như jupyter notebook:</p>

<ul>
  <li>Chúng ta vừa có thể trình bày văn bản kết hợp với xử lý câu lệnh. Các phần trình bày văn bản được tạo ra từ các block text và xử lý code được tạo ra từ các block codes.</li>
</ul>

<p><img src="https://imgur.com/un5hQdr.png" class="normalpic" /></p>

<ul>
  <li>Ngôn ngữ thực thi mặc định của Google colab là python. Ngoài ra bạn có thể thực thi các lệnh command line bằng cách thêm một markup là dấu <code class="highlighter-rouge">!</code> ở đầu câu lệnh.</li>
</ul>

<p>Chẳng hạn bên dưới tôi sẽ chạy một vài lệnh trên commandline của ubuntu để kiểm tra version cuda được google cài đặt.</p>

<p><strong>Command line kiểm tra version cuda:</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>!nvcc --version
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2018 NVIDIA Corporation
Built on Sat_Aug_25_21:08:01_CDT_2018
Cuda compilation tools, release 10.0, V10.0.130
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="32-enable-gpu-trên-google-colab">3.2. Enable GPU trên google colab</h2>

<p>Mặc định google colab sẽ disable GPU để tiết kiệm tài nguyên. Do đó chúng ta enable bằng cách: Trên thanh công cụ của google colab click vào <code class="highlighter-rouge">Runtime &gt; change runtime type</code>.</p>

<p><img src="https://imgur.com/rtwkCPw.png" width="750px" class="normalpic" /></p>

<p>Tại cửa sổ pop-up mục <code class="highlighter-rouge">Hardware accelerator</code> ta lựa chọn GPU và save.</p>

<p><img src="https://imgur.com/tj8SauX.png" width="750px" class="normalpic" /></p>

<p>Muốn biết GPU đã enable thành công chưa, ta sử dụng:</p>

<p><strong>Command line kiểm tra cấu hình GPU</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>!nvidia-smi
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="https://imgur.com/rAiiJoU.png" class="medianpic" /></p>

<p>Như vậy google colab cung cấp 1 GPU Tesla P4 với bộ nhớ 7611MiB. Đây là GPU không quá mạnh nhưng đủ để huấn luyện các model deep learning vừa và nhỏ. Phù hợp với các bạn sinh viên và các nhà data scientist nghèo như mình chẳng hạn.</p>

<h2 id="33-mount-google-drive">3.3. Mount google drive</h2>

<p>Google colab có tác dụng như là một VM (virtual machine computing) làm nhiệm vụ tính toán, xử lý dữ liệu. Google Drive là nơi lưu trữ dữ liệu. Do đó để VM truy cập được tới dữ liệu tại Google drive thì ta cần mount drive.</p>

<p><img src="https://imgur.com/kpeMAsi.png" class="normalpic" /></p>

<p><strong>Câu lệnh mount google drive:</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>

<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s">'/content/gdrive'</span><span class="p">)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre>Go to this URL in a browser: https://accounts.google.com...

Enter your authorization code:
··········
Mounted at /content/gdrive
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Dòng <code class="highlighter-rouge">Enter your authorization code:</code>: Yêu cầu chúng ta nhập token để đăng nhập vào VM.</p>

<p>Click vào link <code class="highlighter-rouge">Go to this URL in a browser</code> để xác thực email. Sau khi accept các bước ta thu được đoạn mã token bên dưới:</p>

<p><img src="https://imgur.com/CQEv7NW.png" class="normalpic" /></p>

<p>Copy token và paste vào dòng <code class="highlighter-rouge">Enter your authorization code:</code>. Sau bước này chúng ta đã establish một connection từ VM đến Google drive.</p>

<h1 id="4-huấn-luyện-yolo-trên-google-colab">4. Huấn luyện YOLO trên google colab</h1>

<h2 id="41-khởi-tạo-project-darknet-trên-google-drive">4.1. Khởi tạo project darknet trên google drive.</h2>

<p><a href="https://github.com/AlexeyAB/darknet">Darknet</a> là một framework open source chuyên biệt về object detection được viết bằng ngôn ngữ C và CUDA. Các mô hình được huấn luyện trên darknet nhanh, đồng thời darknet dễ cài đặt và hỗ trợ tính toán CPU và GPU. Cộng đồng sử dụng darknet đông đảo, đội ngũ support nhiệt tình. Đó là lý do tôi lựa chọn darknet để hướng dẫn các bạn.</p>

<p>Tại bước này chúng ta cần clone project <a href="https://github.com/phamdinhkhanh/darknetGoogleColab.git">darknetGoogleColab</a> mà tôi đã customize lại một chút cho phù hợp với google colab.</p>

<p>Các bạn thực hiện tuần tự như sau:</p>

<p><strong>Step 1</strong>: Thay đổi đường dẫn tới folder mặc định là <code class="highlighter-rouge">My Drive</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>import os

path = "/content/gdrive/My Drive"
os.chdir(path)
</pre></td></tr></tbody></table></code></pre></div></div>

<p><strong>Step 2:</strong> Sử dụng command line để clone git project <code class="highlighter-rouge">darknetTurtorial</code> từ github repo của tôi.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>!git clone https://github.com/phamdinhkhanh/darknetGoogleColab.git
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>Cloning into 'darknetGoogleColab'...
remote: Enumerating objects: 430, done.[K
remote: Counting objects: 100% (430/430), done.[K
remote: Compressing objects: 100% (321/321), done.[K
remote: Total 430 (delta 102), reused 430 (delta 102), pack-reused 0[K
Receiving objects: 100% (430/430), 6.20 MiB | 10.37 MiB/s, done.
Resolving deltas: 100% (102/102), done.
Checking out files: 100% (473/473), done.
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Sau khi chạy thành công bạn kiểm tra trên My Drive của Google drive bạn sẽ thấy folder <code class="highlighter-rouge">darknetGoogleColab</code> vừa mới được clone về.</p>

<p><img src="https://imgur.com/AyeE1q0.png" class="largepic" /></p>

<p>Sau đó chúng ta cd vào folder và phân quyền execute module darknet để có thể chạy được các lệnh trên darknet.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre>%cd darknetGoogleColab

!ls

# phân quyền execute module darknet
!chmod +x ./darknet
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Lúc này chúng ta đã có thể sử dụng được các lệnh của dự báo, huấn luyện của darknet trên hệ điều hành ubuntu.</p>

<h2 id="42-chuẩn-bị-dữ-liệu">4.2. Chuẩn bị dữ liệu</h2>

<h3 id="421-tool-bounding-box">4.2.1. Tool bounding box</h3>

<p>Hiện tại có rất nhiều các open source bounding box tool khác nhau được sử dụng để gán nhãn cho mô hình YOLO. Với kinh nghiệm trải nghiệm các tool này, tôi khuyến nghị các bạn sử dụng <a href="https://pypi.org/project/labelImg/">labelImg</a> của pypi vì những lý do sau:</p>

<p><img src="https://raw.githubusercontent.com/phamdinhkhanh/BBox-Tool/master/labelImage.jpg" class="largepic" /></p>

<ul>
  <li>Giao diện UI/UX khá tốt với đầy đủ chức năng: open, load, save,….</li>
  <li>Hỗ trợ gán nhãn trên cả 2 định dạng COCO xml format và YOLO default txt format.</li>
  <li>Chức năng default bounding box cho phép tự động gán nhãn cho các bức ảnh nằm chung trong một folder. Ví dụ: Khi gán nhãn cho sản phẩm cafe thì các bức ảnh của tôi về cafe đều được xếp về chung 1 folder. Tôi không cần phải gõ lại nhãn mà chỉ cần tạo một default bounding box cho toàn bộ ảnh.</li>
</ul>

<p>Và rất nhiều các chức năng khác.</p>

<p>Việc cài đặt và hướng dẫn sử dụng các bạn đọc tại <a href="https://pypi.org/project/labelImg/">labelImg</a>.</p>

<p>Khi huấn luyện model YOLO trên darknet chúng ta sẽ cần sử dụng đầu vào là các bức ảnh (có thể là một trong các định dạng png, jpg, jpeg) và annotation của chúng (định dạng txt). Bên dưới là nội dung của một file annotation.txt.</p>

<p><img src="https://imgur.com/66Lvm3R.png" class="normalpic" /></p>

<p>Nội dung của file annotation sẽ bao gồm:</p>

<p><code class="highlighter-rouge">&lt;id-class&gt; &lt;center-x&gt; &lt;center-y&gt; &lt;bbox-width&gt; &lt;bbox-height&gt;</code></p>

<p>Trong đó: các giá trị <code class="highlighter-rouge">&lt;center-x&gt; &lt;center-y&gt; &lt;bbox-width&gt; &lt;bbox-height&gt;</code> là tâm và kích thước width, height của bounding box đã được chuẩn hóa bằng cách chia cho width và height của ảnh, do đó các giá trị ngày luôn nằm trong khoảng [0, 1]. <code class="highlighter-rouge">&lt;id-class&gt;</code> là giá trị index đánh dấu các classes.</p>

<p>Trong trường hợp một ảnh có nhiều bounding box thì file annotation sẽ gồm nhiều dòng, mỗi một bounding box là một dòng.</p>

<p>Cảc ảnh và annotation phải được để chung trong cùng 1 folder. Bạn đọc có thể tham khảo qua dữ liệu mẫu <a href="https://github.com/phamdinhkhanh/VinIDProductObjectDetection/tree/master/img">Dữ liệu ảnh sản phẩm TMDT</a>.</p>

<h3 id="422-dữ-liệu-thực-hành">4.2.2. Dữ liệu thực hành</h3>

<p>Trong hướng dẫn này chúng ta cùng xây dựng một mô hình nhận diện sản phẩm thương mại điện tử gồm 5 nhóm mặt hàng: <code class="highlighter-rouge">bia, cafe, mytom, nuoctuong, sua</code>. Để không mất thời gian cho khâu chuẩn bị dữ liệu thì các bạn có thể clone dữ liệu từ git repo của tôi:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>!git clone https://github.com/phamdinhkhanh/VinIDProductObjectDetection.git traindata
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre>Cloning into 'data'...
remote: Enumerating objects: 325, done.[K
remote: Counting objects: 100% (325/325), done.[K
remote: Compressing objects: 100% (139/139), done.[K
remote: Total 325 (delta 2), reused 324 (delta 1), pack-reused 0[K
Receiving objects: 100% (325/325), 12.15 MiB | 15.99 MiB/s, done.
Resolving deltas: 100% (2/2), done.
Checking out files: 100% (216/216), done.
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Lệnh trên sẽ clone dữ liệu về folder <code class="highlighter-rouge">traindata</code> trong project của chúng ta.</p>

<p>Lưu ý: Không được đặt tên folder <code class="highlighter-rouge">traindata</code> trùng với folder <code class="highlighter-rouge">data</code> mặc định của darknet. Nếu không sẽ xảy ra lỗi <code class="highlighter-rouge">Cannot load image</code> khi dự báo và nhãn dự báo của hình ảnh không hiển thị.</p>

<p>Dữ liệu trong folder img sẽ bao gồm các file ảnh và file annotation (có đuôi .txt) của chúng.</p>

<p><img src="https://imgur.com/m477lgr.png" class="normalpic" /></p>

<p>file ảnh và annotation phải cùng tên để darknet có thể matching chúng trong quá trình huấn luyện.</p>

<h3 id="423-phân-chia-dữ-liệu-trainvalidation">4.2.3. Phân chia dữ liệu train/validation</h3>

<p>Ở bước này ta sẽ tạo ra 2 file train.txt và valid.txt chứa dữ liệu đường dẫn tới các file hình ảnh nằm trong tập train và validation. Chúng ta sẽ sử dụng đoạn code bên dưới để lựa chọn ra ngẫu nhiên 20 files làm dữ liệu validation và các files còn lại làm dữ liệu train.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre>import glob2
import numpy as np

all_files = []
for ext in ["*.png", "*.jpeg", "*.jpg"]:
  images = glob2.glob(os.path.join("traindata/img/", ext))
  all_files += images

rand_idx = np.random.randint(0, len(all_files), 20)

# Create train.txt
with open("train.txt", "w") as f:
  for idx in np.arange(len(all_files)):
    # if idx not in rand_idx:
    f.write(all_files[idx]+'\n')

# Create valid.txt
with open("valid.txt", "w") as f:
  for idx in np.arange(len(all_files)):
    if idx in rand_idx:
      f.write(all_files[idx]+'\n')
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="43-cấu-hình-darknet">4.3. Cấu hình darknet</h2>

<h3 id="431-tạo-file-object-name">4.3.1. Tạo file object name</h3>

<p>Đây là files chứa tên các classes mà chúng ta sẽ huấn luyện mô hình. Trên file này, thứ tự các classes name cần phải đặt đúng với index của nó trong các file label của vật thể.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre># Create obj.names config file
!echo bia &gt; obj.names
!echo cafe &gt;&gt; obj.names
!echo mytom &gt;&gt; obj.names
!echo nuoctuong &gt;&gt; obj.names
!echo sua &gt;&gt; obj.names
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Đoạn code trên sử dụng lệnh <code class="highlighter-rouge">echo</code> của <code class="highlighter-rouge">bash</code> để tạo và write nội dung vào file <code class="highlighter-rouge">obj.names</code>. Sau đó, một file <code class="highlighter-rouge">obj.names</code> được tạo thành trong project foler. Bạn có thể mở file này ra để kiểm tra nội dung.</p>

<h3 id="432-tạo-file-config-data">4.3.2. Tạo file config data</h3>

<p>File config data sẽ khai báo một số thông tin như:</p>

<ul>
  <li>Số lượng classes</li>
  <li>Đường dẫn tới các file train.txt, test.txt</li>
  <li>Đường dẫn tới file obj.names</li>
  <li>Thư mục backup mô hình huấn luyện.</li>
</ul>

<p>Chạy lệnh bên dưới để tạo file này.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre># Config obj.data config file
!echo classes=5 &gt; obj.data
!echo train=train.txt &gt;&gt; obj.data
!echo valid=test.txt &gt;&gt; obj.data
!echo names=obj.names &gt;&gt; obj.data
!echo backup=backup &gt;&gt; obj.data
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="433-tạo-file-config-model">4.3.3. Tạo file config model</h3>

<p>Đây là bước quan trọng nhất khi huấn luyện model YOLO. Chúng ta sẽ sử dụng file <a href="https://github.com/pjreddie/darknet/blob/master/cfg/yolov3.cfg">yolov3.cfg</a> để cấu hình mô hình huấn luyện. Các bạn download file trên về máy và điều chỉnh các dòng:</p>

<ul>
  <li>
    <p>Tại các dòng 610, 696, 783: Thay <code class="highlighter-rouge">classes=80</code> thành <code class="highlighter-rouge">classes=5</code> là số lượng classes chúng ta huấn luyện.</p>
  </li>
  <li>
    <p>Tại các dòng 603, 689, 776: Thay số lượng <code class="highlighter-rouge">filters=255</code> về <code class="highlighter-rouge">filter=30</code>. Đây chính là layer cuối cùng của base network. Do đó chúng có output shape thay đổi theo số lượng classes theo đúng công thức của bài trước đó là: <code class="highlighter-rouge">(n_classes + 5)x3 = (5+5)x3 = 30</code>.</p>
  </li>
  <li>
    <p>max_batches: tại dòng 20 là số lượng steps tối đa để huấn luyện models YOLO. Đối với dữ liệu 5 classes chỉ cần điều chỉnh <code class="highlighter-rouge">max_batches=5000</code> là có thể có nghiệm tốt.</p>
  </li>
  <li>
    <p>burn_in: Tại dòng 19 là số lượng steps ban đầu được giữ sao cho learning_rate rất bé. Giá trị này sẽ tăng dần từ 0 đến learning_rate. Sau đó learning_rate sẽ được giữ ổn định. Thực nghiệm cho thấy thiết lập learning_rate bé ở những steps đầu sẽ giúp cho thuật toán hội tụ nhanh hơn. Do số lượng <code class="highlighter-rouge">max_batches</code> chỉ là 5000 nên cần điều chỉnh giảm <code class="highlighter-rouge">burn_in = 100</code>.</p>
  </li>
  <li>
    <p>steps: Tại dòng 22. Điều chỉnh về <code class="highlighter-rouge">steps=4000,4500</code>. Đây là các vị trí step mà chúng ta sẽ bắt đầu giảm dần learning_rate vì thuật toán đã đạt tới điểm hội tụ nên không cần thiết lập learning_rate quá cao.</p>
  </li>
</ul>

<p>Sau khi thực hiện các thay đổi xong, các bạn save file lại và push lên project <code class="highlighter-rouge">darknetGoogleColab</code> của google driver.</p>

<p>Trước đó, hãy đổi tên lại thành <code class="highlighter-rouge">yolov3-5c-5000-maxsteps.cfg</code>
để đánh dấu đây là cấu hình cho yolo version 3 với 5 classes và 5000 bước huấn luyện.</p>

<p>Các file config này đã có sẵn trong github repo của tôi nên bạn có thể download về sử dụng ngay.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>os.path.exists("obj.data")
os.path.exists("yolov3-5c-5000-max-steps.cfg")
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>True
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="44-các-hàm-phụ-trợ">4.4. Các hàm phụ trợ</h2>

<p>Để thuật lợi cho việc đọc và ghi và hiển thị hình ảnh, tôi sẽ xây dựng các hàm phụ trợ có chức năng như sau:</p>

<ul>
  <li>
    <p><code class="highlighter-rouge">imShow()</code>: Hiển thị hình ảnh từ một path.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">upload()</code>: Upload một file từ local lên google drive.</p>
  </li>
  <li>
    <p><code class="highlighter-rouge">download()</code>: Download một file từ một path trên mạng.</p>
  </li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre>#download files
def imShow(path):
  import cv2
  import matplotlib.pyplot as plt
  %matplotlib inline

  image = cv2.imread(path)
  height, width = image.shape[:2]
  resized_image = cv2.resize(image,(3*width, 3*height), interpolation = cv2.INTER_CUBIC)

  fig = plt.gcf()
  fig.set_size_inches(18, 10)
  plt.axis("off")
  #plt.rcParams['figure.figsize'] = [10, 5]
  plt.imshow(cv2.cvtColor(resized_image, cv2.COLOR_BGR2RGB))
  plt.show()
  
  
def upload():
  from google.colab import files
  uploaded = files.upload() 
  for name, data in uploaded.items():
    with open(name, 'wb') as f:
      f.write(data)
      print ('saved file', name)
      
def download(path):
  from google.colab import files
  files.download(path)
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="45-huấn-luyện-mô-hình">4.5. Huấn luyện mô hình</h2>

<h3 id="451-download-pretrain-model">4.5.1. Download pretrain model</h3>

<p>YOLO được huấn luyện trên rất nhiều các model pretrain. Những mô hình này được xây dựng trên các bộ dữ liệu ảnh mẫu lớn như: <a href="http://cocodataset.org/#home">COCO</a>, <a href="http://host.robots.ox.ac.uk/pascal/VOC/">Pascal VOC</a>, <a href="http://image-net.org/download">Imagenet</a>, <a href="https://www.cs.toronto.edu/~kriz/cifar.html">CIFAR</a>.</p>

<p>Đây là những bộ dữ liệu có định dạng và format chuẩn, được đảm bảo bởi các tổ chức và viện nghiên cứu lớn trên thế giới nên chúng ta hoàn toàn có thể yên tâm về chất lượng dữ liệu.</p>

<p>List các danh sách model pretrain các bạn có thể theo dõi tại <a href="https://pjreddie.com/darknet/yolo/">Darknet YOLO</a></p>

<p><img src="https://imgur.com/xJ1d61d.png" class="normalpic" /></p>

<p>Ở ví dụ thực hành này, chúng ta sẽ sử dụng pretrain model <a href="https://pjreddie.com/media/files/darknet53.conv.74">darknet53.conv.74</a> dược huấn luyện từ bộ dữ liệu ImageNet. Trước tiên hãy clone file weight về google drive.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>!wget https://pjreddie.com/media/files/darknet53.conv.74
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre></td><td class="rouge-code"><pre>--2020-03-08 07:55:46--  https://pjreddie.com/media/files/darknet53.conv.74
Resolving pjreddie.com (pjreddie.com)... 128.208.4.108
Connecting to pjreddie.com (pjreddie.com)|128.208.4.108|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 162482580 (155M) [application/octet-stream]
Saving to: ‘darknet53.conv.74’

darknet53.conv.74   100%[===================&gt;] 154.96M  1.11MB/s    in 1m 45s  

2020-03-08 07:57:32 (1.47 MB/s) - ‘darknet53.conv.74’ saved [162482580/162482580]
</pre></td></tr></tbody></table></code></pre></div></div>

<h3 id="452-backup-model">4.5.2. Backup model</h3>

<p>Tạo một folder backup để lưu kết quả huấn luyện sau mỗi 1000 steps. Folder backup này phải trùng với tên với link folder backup đã được khai báo ở step <code class="highlighter-rouge">4.3.3. tạo file config data</code>.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>!mkdir backup
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Nếu để 1000 steps mới backup model có thể khá lâu. Để tránh các lỗi phát sinh khi huấn luyện tại 1000 steps đầu tiên, trong project của mình tôi đã điều chỉnh sẵn last model backup sau mỗi 100 steps.</p>

<h3 id="453-huấn-luyện-model">4.5.3. Huấn luyện model</h3>

<p>Để huấn luyện model ta chỉ cần thực hiện lệnh <code class="highlighter-rouge">detector train</code>.</p>

<p>Tổng quát cú pháp:</p>

<p><code class="highlighter-rouge">!./darknet detector train [data config file] [model config file] [pretrain-model weights] -dont_show &gt; [file log saved]</code></p>

<p>Trong đó các <code class="highlighter-rouge">[data config file]</code>, <code class="highlighter-rouge">[model config file]</code> là những file config. <code class="highlighter-rouge">[pretrain-model weights]</code> là file model pretrain và <code class="highlighter-rouge">[file log saved]</code> là file log quá trình training.</p>

<p>Note: Khi save log vào <code class="highlighter-rouge">[file log saved]</code> thì mặc định mô hình của bạn sẽ không hiển thị log ra ngoài màn hình nữa. Nhiều bạn đã hiểu lầm rằng mô hình ngừng chạy. Để hiển thị log quá trình huấn luyện thì bạn bỏ <code class="highlighter-rouge">&gt; [file log saved]</code> ở cuối câu lệnh.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>!./darknet detector train obj.data yolov3-5c-5000-max-steps.cfg darknet53.conv.74 -dont_show &gt; yolov3-5c.log
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td><td class="rouge-code"><pre>layer     filters    size              input                output
   0 conv     32  3 x 3 / 1   608 x 608 x   3   -&gt;   608 x 608 x  32 0.639 BF
   1 conv     64  3 x 3 / 2   608 x 608 x  32   -&gt;   304 x 304 x  64 3.407 BF
   2 conv     32  1 x 1 / 1   304 x 304 x  64   -&gt;   304 x 304 x  32 0.379 BF
   3 conv     64  3 x 3 / 1   304 x 304 x  32   -&gt;   304 x 304 x  64 3.407 BF
   4 Shortcut Layer: 1
   ...
  94 yolo
  95 route  91
  96 conv    128  1 x 1 / 1    38 x  38 x 256   -&gt;    38 x  38 x 128 0.095 BF
  97 upsample            2x    38 x  38 x 128   -&gt;    76 x  76 x 128
  98 route  97 36
  99 conv    128  1 x 1 / 1    76 x  76 x 384   -&gt;    76 x  76 x 128 0.568 BF
 100 conv    256  3 x 3 / 1    76 x  76 x 128   -&gt;    76 x  76 x 256 3.407 BF
 101 conv    128  1 x 1 / 1    76 x  76 x 256   -&gt;    76 x  76 x 128 0.379 BF
 102 conv    256  3 x 3 / 1    76 x  76 x 128   -&gt;    76 x  76 x 256 3.407 BF
 103 conv    128  1 x 1 / 1    76 x  76 x 256   -&gt;    76 x  76 x 128 0.379 BF
 104 conv    256  3 x 3 / 1    76 x  76 x 128   -&gt;    76 x  76 x 256 3.407 BF
 105 conv     30  1 x 1 / 1    76 x  76 x 256   -&gt;    76 x  76 x  30 0.089 BF
 106 yolo
Total BFLOPS 139.527 
 Allocate additional workspace_size = 13.31 MB 
Loading weights from darknet53.conv.74...Done!
Saving weights to backup/yolov3-5c-5000-max-steps_last.weights
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Nếu bạn nào gặp lỗi:</p>

<p><code class="highlighter-rouge">CUDA Error: out of memory: File exists</code></p>

<p>Hãy quay trở lại file <code class="highlighter-rouge">yolov3-5c-5000-max-steps.cfg</code> và điều chỉnh tăng <code class="highlighter-rouge">subdivisions=32</code>. Sau đó train lại model từ đầu.</p>

<p>Tổng cộng quá trình train hết khoảng <code class="highlighter-rouge">5h</code> đồng hồ. Nếu bạn muốn ngồi đợi thành quả, hãy kiên nhẫn chờ đợi. Hoặc nếu muốn có ngay thành quả, hãy download file <a href="https://drive.google.com/drive/folders/1Oj7yOMEPG59BRVyA3QjVoHWyzX8lNW-E?usp=sharing">pretrain nhận diện sản phẩm TMDT của tôi</a>.</p>

<p>Một số lưu ý:</p>

<ul>
  <li>Log của chương trình sẽ không hiện ra tại màn hình do chúng ta đã save vào file <code class="highlighter-rouge">yolov3-5c.log</code>. Mục đích chính là để lưu lại log nhằm visualize loss function (xem mục 4.5.4). Nếu bạn muốn monitor ngay tại màn hình google colab thì chạy lệnh:</li>
</ul>

<p><code class="highlighter-rouge">!./darknet detector train obj.data yolov3-5c-5000-max-steps.cfg darknet53.conv.74 -dont_show</code></p>

<p>Bạn có thể mở một google colab khác để thực hiện mục <code class="highlighter-rouge">4.5.4 visualize loss function</code>.</p>

<ul>
  <li>
    <p>Đừng quên kiểm tra đường truyền internet thường xuyên. Google Colab sẽ tự động kill các session offline trong vòng 1h. Tức nếu bạn tắt colab hoặc bị disconnect internet thì mọi thứ vẫn tiếp diễn trong 1h và sau đó luồng training sẽ bị kill.</p>
  </li>
  <li>
    <p>Google colab đồng thời cho phép độ dài tối đa của một session là 12h. Vì vậy với các bộ dữ liệu lớn thì huấn luyện mô hình object detection trên google colab là một việc bất khả thi.</p>
  </li>
</ul>

<h3 id="454-visualize-hàm-loss-function">4.5.4. Visualize hàm loss function</h3>

<p>Kết quả huấn luyện của mô hình qua từng step sẽ được lưu vào file <code class="highlighter-rouge">yolov3-5c.log</code>. Chúng ta có thể sử dụng file này để visualize hàm loss function.</p>

<p>Trong git project được customize từ darknet tôi đã code sẵn một file có tác dụng visualize loss function. Ý tưởng xử lý không có gì khó, chúng ta sẽ tìm trong log các dòng có <code class="highlighter-rouge">Average Loss</code> và trích xuất giá trị loss function và visualize. Bạn đọc có thể mở file ra nghiên cứu.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>!python3 plotTrainLoss.py yolov3-5c.log
imShow('training_loss_plot.png')
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="/assets/images/20200310_YOLOGoogleColab/DarknetGoogleColab_50_0.png" class="normalpic" /></p>

<p>Như vậy đồ thị loss function cho thấy thuật toán đã hội tụ sau khoảng 100 batches đầu tiên. Loss function ở giai đoạn sau có xu hướng tiệm cận 0. Điều này chứng tỏ chiến lược lựa chọn learning_rate nhỏ ở 100 steps đầu tiên đã phát huy hiệu quả giúp thuật toán hội tụ nhanh hơn.</p>

<h2 id="46-dự-báo">4.6. Dự báo</h2>

<p>Sau khi huấn luyện xong mô hình, kết quả sau cùng sẽ được lưu trong folder backup</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>!ls backup
</pre></td></tr></tbody></table></code></pre></div></div>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>yolov3-5c-5000-max-steps_last.weights
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Để dự báo cho một bức ảnh ta sử dụng cú pháp:</p>

<p><code class="highlighter-rouge">!./darknet detector test [data config file] [model config file] [last-model weights] [image path] -dont_show</code></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>!./darknet detector test obj.data yolov3-5c-5000-max-steps-test.cfg backup/yolov3-5c-5000-max-steps_last.weights traindata/test/nuoctuong3.jpg -dont_show

imShow('predictions.jpg')
</pre></td></tr></tbody></table></code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>traindata/test/nuoctuong3.jpg: Predicted in 56.505000 milli-seconds.
nuoctuong: 34%
nuoctuong: 87%
nuoctuong: 96%
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="/assets/images/20200310_YOLOGoogleColab/DarknetGoogleColab_55_1.png" class="normalpic" /></p>

<p>Do google colab suppress các hàm graphic của opencv nên ta không thể show image trực tiếp mà phải save kết quả vào file <code class="highlighter-rouge">predictions.jpg</code>.</p>

<p>argument <code class="highlighter-rouge">-dont_show</code> để by pass các lỗi graphic của opencv.</p>

<p>Như vậy chúng ta đã hoàn thành quá trình huấn luyện và dự báo một mô hình object detection trên google colab. Cũng không quá khó khăn phải không nào?</p>

<h1 id="5-ước-tính-thời-gian-huấn-luyện">5. Ước tính thời gian huấn luyện</h1>

<p>Khi hiểu kỹ về lý thuyết của mô hình YOLO các bạn sẽ hiểu lý do tại sao model YOLO lại huấn luyện lâu như vậy. Từ một ảnh đầu vào kích thước <code class="highlighter-rouge">418x418</code>, YOLO sẽ cần dự đoán nhãn và tọa độ của tổng cộng <code class="highlighter-rouge">(13x13+26x26+52x52)x3 = 10647</code> bounding boxes. Giả sử mỗi một batch của chúng ta có kích thước 64 ảnh và số lượng <code class="highlighter-rouge">max_batches = 5000</code>. Như vậy chúng ta cần dự báo cho tổng cộng: <code class="highlighter-rouge">10647x5000x64 = 3.4 triệu</code> bounding boxes. Đây là một con số không hề nhỏ nên quá trình huấn luyện trên google colab sẽ mất tới vài h.</p>

<p>Google colab sẽ chỉ cho phép bạn huấn luyện trong 12h liên tục. Do đó, trước khi huấn luyện chúng ta cần ước lượng tổng thời gian huấn luyện để không vượt quá giới hạn time. Tôi sẽ giới thiệu các bạn một số mẹo ước tính và tiết kiệm thời gian huấn luyện.</p>

<ul>
  <li>
    <p>Nên ước tính tổng thời gian huấn luyện dựa trên thời gian huấn luyện của 1 batch. Nếu bạn huấn luyện một batch hết 3.6s. Như vậy 5000 batches sẽ tiêu tốn của bạn khoảng: <code class="highlighter-rouge">(3.6x5000)/3600 = 5 h</code> huấn luyện. Tất nhiên đây chỉ là ước tính tương đối vì không phải mọi batch đều được huấn luyện với thời gian bằng nhau. Nếu gặp những batch có hình ảnh lỗi, format không tương thích thì có thể tốn rất nhiều thời gian để chương trình gỡ lỗi.</p>
  </li>
  <li>
    <p>Hãy save log trong quá trình huấn luyện và vẽ biểu đồ loss function. Biểu đồ loss function cho ta biết quá trình huấn luyện đã đi tới trạng thái hội tụ hay chưa? Có thể dừng sớm quá trình huấn luyện nếu bạn quan sát thấy loss function dường như đã hội tụ.</p>
  </li>
  <li>
    <p>Huấn luyện trên nhiều GPU song song (cách này chỉ áp dụng với các bạn sở hữu nhiều GPU, không áp dụng trên google colab). Khi huấn luyện trên nhiều GPU thì nên giảm learning_rate xuống theo cấp số nhân. Chẳng hạn bạn huấn luyện trên 4 GPU thì cần thiết lập learning_rate mới bằng 1/4 learning_rate mặc định trên 1 GPU. Quá trình huấn luyện sẽ nhanh hơn rất nhiều.</p>
  </li>
  <li>
    <p>Sử dụng pretrain model trên bộ dữ liệu gần giống với bộ dữ liệu đang huấn luyện. Khi đó các trọng số của mô hình pretrain và mô hình tối ưu cho bộ dữ liệu sẽ gần sát nhau. Chúng ta sẽ chỉ cần ít steps huấn luyện hơn để đạt kết quả tốt so với lựa chọn pretrain model được huấn luyện từ một bộ dữ liệu khác biệt lớn.</p>
  </li>
  <li>
    <p>Update cuDNN version (đối với các bạn huấn luyện trên máy tính cá nhân, môi trường xịn sò của google colab đã update sẵn cuDNN). Như đã giới thiệu ở mục 1 cấu hình cuDNN. Những kiến trúc cuDNN mới đã được tối ưu hơn rất nhiều giúp tăng tốc quá trình huấn luyện. Sử dụng cuDNN version 7.6 có thể tăng tốc gấp 2 lần so với version 6.0. Do đó hãy cập nhật cuDNN nếu bạn đang sử dụng version cũ. Nhưng lưu ý là cuDNN cần tương thích version với CUDA để tránh các lỗi phát sinh nhé.</p>
  </li>
  <li>
    <p>Cân nhắc sử dụng kiến trúc đơn giản. Các kiến trúc của YOLO khác đa dạng tùy thuộc vào base network. Các bạn xem lại bài giới thiệu về YOLO để hiểu rõ hơn kiến trúc này. Nếu một số tác vụ với ít classes thì chênh lệch về độ chính xác giữa mô hình kiến trúc phức tạp và đơn giản sẽ không quá lớn. Bạn có thể đặt ra trước cho mình một tiêu chuẩn về mAP của mô hình và huấn luyện thử với các model có kiến trúc đơn giản như tiny YOLO. Có thể những mô hình này đã đạt được tiêu chuẩn. Hơn nữa tốc độ dự báo nhanh và có thể triển khai trên các thiết bị IoT cấu hình thấp là một trong những điểm cộng cho các mô hình như vậy. Simple is the best!</p>
  </li>
</ul>

<h1 id="6-các-lưu-ý-khi-huấn-luyện-mô-hình">6. Các lưu ý khi huấn luyện mô hình</h1>

<p>Các lưu ý khi huấn luyện model darknet</p>

<ul>
  <li>Đặt đúng đường link config data: Trong data file chúng ta khai báo các đường dẫn tới các file cấu hình. Các đường dẫn này nếu là địa chỉ tương đối phải được cấu hình theo vị trí mà chúng ta run model để có thể truy cập được. Nội dung của những file này như sau:
    <ul>
      <li>Files train.txt và text.txt: Đây là những files chứa đường link tới ảnh. Mô hình sẽ load các ảnh từ những đường links này để huấn luyện và kiểm định. Do đó các đường links trong 2 files nên được để là đường link tuyệt đối để không gặp lỗi khi chuyển folders.</li>
      <li>File obj.names: File chứa tên của các classes. Thứ tự của tên từ trên xuống dưới phải được đặt đúng với thứ tự index của classes được khai báo trong các file annotation của ảnh (element đầu tiên của các file<code class="highlighter-rouge">[image_id].txt</code>).</li>
      <li>Folder backup: Là folder được sử dụng để backup kết quả của quá trình huấn luyện. Sau mỗi 1000 batches thì model sẽ được backup một bản tại đây. Đường dẫn này nên được để theo vị trí tuyệt đối để tránh các lỗi phát sinh.</li>
    </ul>
  </li>
  <li>Cấu hình model YOLO:
    <ul>
      <li>Thay đổi <code class="highlighter-rouge">classes</code>: Tất cả các tham số <code class="highlighter-rouge">classes</code> phải được đưa về đúng bằng số lượng <code class="highlighter-rouge">classes</code> của dữ liệu chúng ta đang huấn luyện. Mặc định của những file cấu hình đang để là 80 chính là số lượng classes của COCO dataset.</li>
      <li>Thay đổi <code class="highlighter-rouge">filters</code> ở layers cuối cùng: Các filters của layer cuối cùng phải được điều chỉnh theo số lượng classes theo công thức <code class="highlighter-rouge">(num_classes+5)x3</code>. Trong đó <code class="highlighter-rouge">num_classes</code> là kích thước của véc tơ phân phối xác suất toàn bộ classes đầu ra và 5 là số lượng các tham số bao gồm 4 tham số của tọa độ <code class="highlighter-rouge">&lt;bbox-x-ratio&gt; &lt;bbox-y-ratio&gt; &lt;bbox-width-ratio&gt; &lt;bbox-height-ratio&gt;</code> và 1 tham số $p_x$ dự báo xác suất có vật thể trong anchor box hay không. 3 chính là số lượng các anchors.</li>
    </ul>
  </li>
  <li>Thay đổi tham số huấn luyện model:
    <ul>
      <li>Số lượng batches huấn luyện: Đối với bộ dữ liệu có số lượng classes lớn (khoảng vài chục classes) thì số lượng batches huấn luyện (tham số <code class="highlighter-rouge">max_batches</code>) ít nhất khoảng 50000 là có thể đạt được kết quả tốt. Đối với bộ dữ liệu có số lượng classes nhỏ (&lt;5 classes) thì <code class="highlighter-rouge">max_batches</code> chỉ cần khoảng 4000 đã có thể thu được kết quả tốt. Qúa trình huấn luyện này tốn khá nhiều thời gian. Đối với 50000 batches với kích thước batch_size = 16 có thể tốn 2-3 ngày huấn luyện trên 1 GPU.</li>
      <li>Mini-batch phải fit với RAM: Tham số <code class="highlighter-rouge">subdivisions</code> sẽ khai báo số lượng các mini-batch được chia ra từ 1 batch để đưa vào mô hình huấn luyện. Nếu <code class="highlighter-rouge">batch_size = 64, subdivisions = 8</code> thì kích thước của <code class="highlighter-rouge">mini-batch = batch_size/8 = 8</code> ảnh. Số lượng các khung hình được sinh ra từ một ảnh là rất lớn nên dù chỉ 8 ảnh cũng có thể vượt quá kích thước RAM. Đối với cấu hình của google colab kích thước 12GB RAM thì chúng ta có thể fit được 4 ảnh.</li>
      <li>Cấu hình tham số huấn luyện: Qúa trình huấn luyện các mạng neural cho thấy các steps đầu tiên nên dược thiết lập với learning rate rất nhỏ để mô hình không step khỏi global optimal. Do đó tham số <code class="highlighter-rouge">burn_in=1000</code> cho phép learning rate của chúng ta tăng dần từ 0 tới <code class="highlighter-rouge">learning_rate</code> trong 1000 steps đầu tiên. Sau đó <code class="highlighter-rouge">learning_rate</code> sẽ được giữ nguyên. Và đến các batch ở vị trí gần cuối như <code class="highlighter-rouge">80%</code> hoặc <code class="highlighter-rouge">90%</code> thì chúng ta sẽ giảm <code class="highlighter-rouge">learning_rate</code> xuống với tốc độ giảm là 10 lần. Ở những vị trí này model gần đạt tới global optimal nên không cần phải giữ <code class="highlighter-rouge">learning_rate</code> quá cao.</li>
    </ul>
  </li>
  <li>
    <p>Nên backup lại log của quá trình huấn luyện: quá trình huấn luyện nên được backup lại trên một file log để có thể visualize sau huấn luyện loss function. Những đồ thị này sẽ giúp ích cho chúng ta tìm kiếm các tham số schedule learning tối ưu cho những đợt huấn luyện sau.</p>
  </li>
  <li>Lỗi <code class="highlighter-rouge">Unable to init server: Could not connect: Connection refused</code>: Đây là lỗi xuất hiện khi huấn luyện trên google colab. Lỗi liên quan tới việc sử dụng GUI của <code class="highlighter-rouge">opencv</code>. Google colab đã disable chức năng của GUI khiến cho code bị dừng. Chúng ta có thể chuyển tiếp lỗi này bằng cách pass thêm argument <code class="highlighter-rouge">-dont_show</code>.</li>
</ul>

<h1 id="7-tổng-kết">7. Tổng kết</h1>

<p>Như vậy tôi đã giới thiệu đến các bạn các bước chi tiết để huấn luyện một mô hình YOLO trên project darknet. Việc huấn luyện mô hình sẽ đòi hỏi các bạn phải có máy tính cấu hình cao, có hỗ trợ GPU. Tuy nhiên với các bạn sinh viên nghèo vượt khó hoặc sinh viên giàu nhưng tiết kiệm có thể áp dụng hướng dẫn này để tự huấn luyện model mô hình cho các tác vụ object detection của mình trên google colab mà không cần phải lo lắng.</p>

<p>Code của project này đã được tổng hợp trên git repo <a href="https://github.com/phamdinhkhanh/darknetGoogleColab">darknetGoogleColab</a>. Các lỗi phát sinh đã được note khá chi tiết ở mục <strong>6. Các lưu ý khi huấn luyện mô hình</strong>. Để thực hành nhanh chóng, bạn có thể mở file <a href="https://colab.research.google.com/drive/1G3AM3CHsMb0iwuBDR-j5rimr_WX2KHc2">darknetGoogleColab.ipynb</a> và thực hiện từ bước <strong>3.2. Enable GPU trên google colab</strong>. Nếu gặp lỗi phát sinh, vui lòng tạo một issue trên git repo:</p>

<p><img src="https://imgur.com/GDEBobU.png" class="largepic" /></p>

<p>Tôi khuyến nghị các bạn đọc qua thuật toán YOLO tại <a href="https://phamdinhkhanh.github.io/2020/03/09/DarknetAlgorithm.html">Bài 25 - YOLO You Only Look Once</a> để hiểu một chút về lý thuyết.</p>

<h1 id="8-tài-liệu-tham-khảo">8. Tài liệu tham khảo</h1>

<ol>
  <li><a href="https://github.com/phamdinhkhanh/darknetGoogleColab">phamdinhkhanh - darknet git repo</a></li>
  <li><a href="https://phamdinhkhanh.github.io/2020/03/09/DarknetAlgorithm.html">Bài 25 - YOLO You Only Look Once - Khanh blog</a></li>
  <li><a href="https://github.com/pjreddie/darknet">pjreddie - darknet git repo</a></li>
  <li><a href="https://github.com/AlexeyAB/darknet">AlexeyAB - darknet git repo</a></li>
  <li><a href="https://phamdinhkhanh.github.io/2020/03/09/DarknetAlgorithm.html">Bài 25 - YOLO You Only Look Once</a></li>
</ol>

<script data-ad-client="ca-pub-4263248182804679" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<button onclick="topFunction()" id="myBtn" title="Go to top">Top</button>

<script src="/js/toc.js"></script>
<script src="/js/btnTop.js"></script>
<script type="text/javascript">
$(document).ready(function() {
    $('#toc').toc();
});
</script>
				</div>
			</div>
			<div class="col-md-2 hidden-xs hidden-sm">
				<a  href="/">
					<img width="100%" style="padding-bottom: 3mm;" src="/assets/images/logo.jpg" /> </a>
				<br>
				<nav>
					<div class="header">Khanh's site</div>
					<li><a style="text-align: left; color: #074B80"  href="https://www.facebook.com/TowardDataScience">phamdinhkhanh blog</a></li>
					<li><a style="text-align: left; color: #074B80"  href="https://www.facebook.com/groups/3235479620010379/">phamdinhkhanh AICode forum</a></li>
					<li><a style="text-align: left; color: #074B80"  href="https://kaggle.com/phamdinhkhanh">phamdinhkhanh kaggle</a></li>
					<li><a style="text-align: left; color: #074B80"  href="http://rpubs.com/phamdinhkhanh">phamdinhkhanh rpub</a></li>
					<li><a style="text-align: left; color: #074B80"  href="https://github.com/phamdinhkhanh">phamdinhkhanh github</a></li>
					<br>
					<div class="header">other's site</div>
					<li><a style="text-align: left; color: #074B80"  href="https://www.facebook.com/groups/machinelearningcoban/">machine learning cơ bản facebook</a></li>
					<li><a style="text-align: left; color: #074B80"  href="https://forum.machinelearningcoban.com/">machine learning cơ bản forum</a></li>
					<li><a style="text-align: left; color: #074B80"  href="https://machinelearningmastery.com">machine learning mastery</a></li>
					<li><a style="text-align: left; color: #074B80"  href="https://viblo.asia">viblosia</a></li>
					<br>
					<div class="header">Khóa học</div>
					<li><a style="text-align: left; color: #074B80"  href="http://web.stanford.edu/class/cs109/">Xác suất thống kê(Probability): CS109</a></li>
					<li><a style="text-align: left; color: #074B80"  href="http://web.stanford.edu/class/cs246/">Bigdata: CS246</a></li>
					<li><a style="text-align: left; color: #074B80"  href="http://cs231n.stanford.edu/">Computer vision cơ bản: CS231N</a></li>
					<li><a style="text-align: left; color: #074B80"  href="http://web.stanford.edu/class/cs224n/">Natural Language Processing: CS224N</a></li>
					<li><a style="text-align: left; color: #074B80"  href="http://web.stanford.edu/class/cs224w/">Khoá phân tích mạng lưới (analysis of network): CS224W</a></li>
					<li><a style="text-align: left; color: #074B80"  href="https://web.stanford.edu/class/cs20si/">Khóa học Tensorflow: CS20SI</a></li>
				</nav>
			</div>
		</div>
	</div>
	
</body>
</html>
